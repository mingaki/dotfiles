{
  description = "Cross-platform CLI development environment";

  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixpkgs-unstable";
  };

  outputs = { self, nixpkgs }:
    let
      system = "{{ .nixPlatform }}";
      pkgs = nixpkgs.legacyPackages.${system};
    in
    {
      packages.${system}.default = pkgs.buildEnv {
        name = "dev-environment";
        paths = with pkgs; [
          # Config management
          chezmoi
          
          # Core utilities
          fd
          fzf
          starship
          tmux
          bat
          btop
          delta
          eza
          jq
          ripgrep
          tldr
          yazi
          zoxide

          # Development tools
          lazydocker
          lazygit
          awscli
          gh
          heroku

          # Build tools
          cmake
          cargo

          # Language servers and formatters
          bash-language-server
          shfmt
          lua-language-server
          stylua
          black
          ruff
          pyright
          uv
          typescript-language-server
          prettierd
          nil
          nixfmt-rfc-style
          marksman
          markdownlint-cli2

          # Unfree packages
          terraform-docs
        ];
      };

      devShells.${system}.default = pkgs.mkShell {
        buildInputs = [ self.packages.${system}.default ];
      };
    };
}